{% extends 'base.html' %}
{% include './partials/_menu.html' %}

{% block main %}
<div class="container py-4">
    <h2 class="mb-4">Données de santé - {{ patient.first_name }} {{ patient.last_name }}</h2>
    
    <div class="row">
        <div class="col-lg-6 mx-auto">
            <form method="POST" action="{{ url_for('new_health_data', id=patient.id) }}" class="needs-validation" novalidate>
                <!-- Date de l'examen -->
                <div class="mb-3">
                    <div class="form-floating">
                        <input type="datetime-local" class="form-control" id="date_examen" 
                               name="date_examen" value="{{ request.form.get('date_examen', default_date) }}"
                               placeholder="Date de l'examen">
                        <label for="date_examen">Date de l'examen</label>
                    </div>
                </div>

                <!-- Mesures physiques -->
                <div class="row g-3 mb-3">
                    <div class="col-sm-6">
                        <div class="form-floating">
                            <input type="number" class="form-control" id="weight" 
                                   name="weight" value="{{ request.form.weight }}"
                                   placeholder="Poids">
                            <label for="weight">Poids (kg)</label>
                        </div>
                    </div>
                    <div class="col-sm-6">
                        <div class="form-floating">
                            <input type="number" class="form-control" id="height" 
                                   name="height" value="{{ request.form.height }}"
                                   placeholder="Taille">
                            <label for="height">Taille (cm)</label>
                        </div>
                    </div>
                </div>

                <!-- Mesures cardiaques -->
                <div class="row g-3 mb-3">
                    <div class="col-sm-6">
                        <div class="form-floating">
                            <input type="number" class="form-control" id="heart_rate" 
                                   name="heart_rate" value="{{ request.form.heart_rate }}"
                                   placeholder="Pulsation cardiaque">
                            <label for="heart_rate">Pulsation cardiaque (bpm)</label>
                        </div>
                    </div>
                    <div class="col-sm-3">
                        <div class="form-floating">
                            <input type="number" class="form-control" id="blood_pressure_sys" 
                                   name="blood_pressure_sys" value="{{ request.form.blood_pressure_sys }}"
                                   placeholder="Systolique">
                            <label for="blood_pressure_sys">Systolique</label>
                        </div>
                    </div>
                    <div class="col-sm-3">
                        <div class="form-floating">
                            <input type="number" class="form-control" id="blood_pressure_dia" 
                                   name="blood_pressure_dia" value="{{ request.form.blood_pressure_dia }}"
                                   placeholder="Diastolique">
                            <label for="blood_pressure_dia">Diastolique</label>
                        </div>
                    </div>
                </div>

                <!-- Température -->
                <div class="mb-3">
                    <div class="form-floating">
                        <input type="number" class="form-control" id="temperature" 
                               name="temperature" value="{{ request.form.temperature }}"
                               step="0.1" min="35" max="42"
                               placeholder="Température">
                        <label for="temperature">Température (°C)</label>
                    </div>
                </div>

                <!-- Notes -->
                <div class="mb-4">
                    <div class="form-floating">
                        <textarea class="form-control" id="notes" name="notes" 
                                  style="height: 100px" placeholder="Notes">{{ request.form.notes }}</textarea>
                        <label for="notes">Notes</label>
                    </div>
                </div>

                <!-- Bouton de soumission -->
                <div class="d-grid">
                    <button type="submit" class="btn btn-primary">Enregistrer</button>
                </div>
            </form>

            {% if error %}
            <div class="alert alert-danger mt-3" role="alert">
                <i class="bi bi-exclamation-triangle-fill me-2"></i>
                <strong>Erreur:</strong> {{ error }}
            </div>
            {% endif %}
        </div>
    </div>
</div>
{% endblock main %}
